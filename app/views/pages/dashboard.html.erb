<!-- <div id="particles-js"></div> -->

<div class="container home-grid">
  <% if @task.nil?  %>
    <div class="row justify-content-between align-items-center" id="download-box">
      <div class="col-md-9 d-none d-md-block">
        <h1 id="home-header">You haven't use any of our algorithm</h1>
        <p>Start by uploading a CSV data you want to clean, and see what's gonna happen in a click.</p>
      </div>
      <div class="col-md-3 col-sm-12 text-center"> <!-- How to make it invisible on the sm device -->
        <%= link_to root_path, class: "prompt"  do %>
          <p>Give it a try!</p>
        <% end %>
        <!-- Once downloaded, change the icon with rating prompts? Javascript? -->
      </div>
    </div>
  <% elsif @task.file.attached? %>
    <div class="row justify-content-between align-items-center" id="download-box">
      <div class="col-md-9 d-none d-md-block">
        <h1 id="home-header">Download your clean data here</h1>
        <p>Make sure you save it to your computer, since we are not going to keep your file.</p>
      </div>
      <div class="col-md-3 col-sm-12 text-center"> <!-- How to make it invisible on the sm device -->
          <%= link_to  download_path(@task), method: :post do %>
            <i class="fas fa-download"></i>
            <div id="filename"><%= @task.file.blob.filename %></div>
          <% end %>
        <!-- Once downloaded, change the icon with rating prompts? -->
        <p id="rating-text">How was your experience using <%= @task.algorithm.name %> algortihm?</p>
        <select id="example">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
<!--         <div id="rating-yellow">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="far fa-star"></i>
        </div> -->
      </div>
    </div>
  <% end %>
  <div class="row justify-content-between" id="dash-main-card">
    <div class="col-lg-4 col-md-12">
      <div class="graph-card">
        <canvas id="UploadsChart" ></canvas>
        <script src='Chart.min.js'></script>
      </div>
      <div class="graph-card">
        <canvas id="RowsChart" ></canvas>
          <script src='Chart.min.js'></script>
      </div>
    </div>
    <div class="col-lg-8 col-md-4">
      <div class="pie-chart">
        <canvas id="AlgoChart" ></canvas>
          <script src='Chart.min.js'></script>
      </div>
      <div class="col-12">
        <% unless @task.nil?  %>
          <h3>Your most used algorithms</h3>
          <!-- Replace skeleton below with working code: -->
          <% counter = Hash.new 0 %>
          <% @user_tasks.each { |task| counter[task.algorithm.name] += 1} %>
          <% algorithm_rank = counter.sort_by { |_,v| -v } %>
          <% total_tasks = algorithm_rank.map { |element| element[1]} %>
          <% total = total_tasks.reduce(:+) %>
          <% algorithm_rank.first(3).to_h.each do |key, value| %>
            <div class="row algorithm-list">
              <div class="col-md-1 d-none d-sm-block text-left mx-1">
                <%= (value.fdiv(total) * 100).ceil() %>%
              </div>
              <div class="col-md-5 col-sm-12 text-left mx-1">
                <%= key %>
              </div>
              <div class="col-md-5 d-none d-md-block mx-2 text-right align-items-center">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
                <i class="far fa-star"></i>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>


<!-- Script to run live rating -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="jquery.barrating.min.js"></script>
<!-- <script type="text/javascript">
   $(function() {
      $('#example').barrating({
        theme: 'fontawesome-stars'
      });
   });
</script> -->
